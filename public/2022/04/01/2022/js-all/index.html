<!DOCTYPE html>


<html lang="en">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>JS终极总结 |  crazyzsh博客空间</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-2022/js-all"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  JS终极总结
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/01/2022/js-all/" class="article-date">
  <time datetime="2022-04-01T15:08:07.000Z" itemprop="datePublished">2022-04-01</time>
</a>   
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">10.4k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">49 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h1><h2 id="常见API"><a href="#常见API" class="headerlink" title="常见API"></a>常见API</h2><h3 id="Object-entries"><a href="#Object-entries" class="headerlink" title="Object.entries"></a>Object.entries</h3><blockquote>
<p><code>Object.entries()</code>方法<strong>返回</strong>一个给定对象自身可枚举属性的<strong>键值对数组</strong>，其排列与使用 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/for...in"><code>for...in</code></a> 循环遍历该对象时返回的顺序一致（区别在于 for-in 循环还会枚举<strong>原型链中的属性</strong>）。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> object1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="string">&#x27;somestring&#x27;</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">42</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> [key, value] <span class="keyword">of</span> <span class="built_in">Object</span>.entries(object1)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>: <span class="subst">$&#123;value&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// expected output: &quot;a: somestring&quot; / &quot;b: 42&quot;</span></span><br></pre></td></tr></table></figure>

<p>将Object转化为Map</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map"><code>new Map()</code></a> 构造函数接受一个可迭代的<code>entries</code>。借助<code>Object.entries</code>方法可以很容易的将<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object"><code>Object</code></a>转换为<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map"><code>Map</code></a>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">foo</span>: <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">    <span class="attr">baz</span>: <span class="number">42</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="built_in">Object</span>.entries(obj));</span><br><span class="line"><span class="built_in">console</span>.log(map); <span class="comment">// Map &#123; foo: &quot;bar&quot;, baz: 42 &#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="getter-setter"><a href="#getter-setter" class="headerlink" title="getter/setter"></a>getter/setter</h2><h2 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h2><p><strong>Proxy</strong> 对象用于创建一个<strong>对象</strong>的代理，从而实现基本操作的拦截和自定义（如属性查找、赋值、枚举、函数调用等）。Proxy的特点如下：</p>
<ul>
<li><code>setter/getter</code> 是对<strong>单个对象属性</strong>的控制，而代理是对整个<strong>对象</strong>的控制。</li>
</ul>
<ul>
<li>读写属性时代码更简洁</li>
<li>对象的多个属性控制统一交给代理完成</li>
<li>严格模式下 <code>set</code> 必须返回布尔值</li>
</ul>
<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><blockquote>
<p><code>const p = new Proxy(target, handler)</code></p>
<p>target：要使用 <code>Proxy</code> 包装的目标对象（可以是任何类型的对象，包括原生<strong>数组</strong>，<strong>函数</strong>，甚至<strong>另一个代理</strong>）。</p>
<p>handler：一个通常以函数作为属性的<strong>对象</strong>，各属性中的函数分别定义了在执行各种操作时代理 <code>p</code> 的行为。</p>
</blockquote>
<h4 id="1-handler-get"><a href="#1-handler-get" class="headerlink" title="1.handler.get()"></a><strong>1.<code>handler.get()</code></strong></h4><p>用于拦截对象的<strong>读取属性</strong>操作，常用前两个参数，get方法可以<strong>返回任何值</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="function"><span class="keyword">function</span> (<span class="params">target, property, receiver</span>) </span>&#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="2-hander-set"><a href="#2-hander-set" class="headerlink" title="2.hander.set()"></a>2.<strong><code>hander.set()</code></strong></h4><p><strong>设置属性值</strong>操作的捕获器，<strong>常用前两个参数</strong>，<strong>receiver</strong>为Proxy或者继承Proxy的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</span><br><span class="line">    <span class="attr">set</span>: <span class="function"><span class="keyword">function</span> (<span class="params">target, property, value, receiver</span>) </span>&#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>特别注意：读取、设定值都必须<strong>经过代理</strong>才能使得get和set生效，如果直接<strong>改变原对象</strong>，那么get和set方法都不会生效，但是此时<strong>代理对象的值</strong>确实已经<strong>改变了</strong></p>
<p>牛刀小试</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> handler = &#123;</span><br><span class="line">    <span class="function"><span class="title">get</span>(<span class="params">obj, key</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// if (obj[key] == &#x27;zsh&#x27;)</span></span><br><span class="line">        <span class="keyword">if</span> (key == <span class="string">&#x27;name&#x27;</span>) <span class="keyword">return</span> <span class="string">&#x27;crazyzsh&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">set</span>(<span class="params">obj, key, value</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (key == <span class="string">&#x27;age&#x27;</span>) &#123;</span><br><span class="line">            obj[key] = <span class="number">118</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> objProxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, handler)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取值【此时会触发get()方法，上述get方法中，只要一读取到name属性，它的返回值就是读取到的值】</span></span><br><span class="line"><span class="built_in">console</span>.log(objProxy.name);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改值【此时会触发set()方法，上set方法中，只要通过代理设定age值，那么age值就是设定的age值】</span></span><br><span class="line">objProxy.age = <span class="number">17</span></span><br><span class="line"><span class="built_in">console</span>.log(objProxy);</span><br></pre></td></tr></table></figure>

<h4 id="3-handler-apply"><a href="#3-handler-apply" class="headerlink" title="3.handler.apply()"></a><strong>3.<code>handler.apply()</code></strong></h4><p>用于拦截函数的调用，相关参数如下：</p>
<ul>
<li>target：目标对象（函数）</li>
<li>thisArg：被调用时的上下文对象</li>
<li>argumentsList：被调用时的参数数组</li>
<li>返回值：apply方法可以返回任何值</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</span><br><span class="line">    <span class="attr">apply</span>: <span class="function"><span class="keyword">function</span> (<span class="params">target, thisArg, argumentsList</span>) </span>&#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">    <span class="attr">apply</span>: <span class="function"><span class="keyword">function</span> (<span class="params">target, thisArg, argumentsList</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Calculate sum: <span class="subst">$&#123;argumentsList&#125;</span>`</span>); <span class="comment">// expected output: &quot;Calculate sum: 1,2&quot;</span></span><br><span class="line">        <span class="keyword">return</span> target(argumentsList[<span class="number">0</span>], argumentsList[<span class="number">1</span>]) * <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy1 = <span class="keyword">new</span> <span class="built_in">Proxy</span>(sum, handler);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">1</span>, <span class="number">2</span>)); <span class="comment">// expected output: 3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(proxy1(<span class="number">1</span>, <span class="number">2</span>)); <span class="comment">// expected output: 30</span></span><br></pre></td></tr></table></figure>

<h3 id="实用例子"><a href="#实用例子" class="headerlink" title="实用例子"></a>实用例子</h3><h4 id="截取字符串"><a href="#截取字符串" class="headerlink" title="截取字符串"></a>截取字符串</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">    <span class="comment">// 当代理的是数组时，此时的index就为索引</span></span><br><span class="line">    <span class="function"><span class="title">get</span>(<span class="params">target, key</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> title = target[key].title;</span><br><span class="line">        <span class="comment">// 指定截取长度</span></span><br><span class="line">        <span class="keyword">const</span> len = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">return</span> title.length &gt; len ?</span><br><span class="line">            title.substr(<span class="number">0</span>, len) + <span class="string">&quot;.&quot;</span>.repeat(<span class="number">3</span>) :</span><br><span class="line">            title;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> lessons = [&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;媒体查询响应式布局&quot;</span>,</span><br><span class="line">        <span class="attr">category</span>: <span class="string">&quot;css&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;FLEX 弹性盒模型&quot;</span>,</span><br><span class="line">        <span class="attr">category</span>: <span class="string">&quot;css&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;MYSQL多表查询随意操作&quot;</span>,</span><br><span class="line">        <span class="attr">category</span>: <span class="string">&quot;mysql&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> stringDotProxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(lessons, handler);</span><br><span class="line"><span class="built_in">console</span>.log(stringDotProxy[<span class="number">2</span>]); <span class="comment">//MYSQL...</span></span><br></pre></td></tr></table></figure>

<h4 id="双向绑定"><a href="#双向绑定" class="headerlink" title="双向绑定"></a>双向绑定</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;title&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;title&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind</span>=<span class="string">&quot;title&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">View</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">//设置代理拦截</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span></span><br><span class="line"><span class="javascript">                <span class="function"><span class="title">get</span>(<span class="params">obj, property</span>)</span> &#123;&#125;,</span></span><br><span class="line"><span class="javascript">                <span class="function"><span class="title">set</span>(<span class="params">obj, property, value</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                    obj[property] = value;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">document</span></span></span><br><span class="line"><span class="javascript">                        .querySelectorAll(</span></span><br><span class="line"><span class="javascript">                            <span class="string">`[v-model=&quot;<span class="subst">$&#123;property&#125;</span>&quot;],[v-bind=&quot;<span class="subst">$&#123;property&#125;</span>&quot;]`</span></span></span><br><span class="line"><span class="javascript">                        )</span></span><br><span class="line"><span class="javascript">                        .forEach(<span class="function"><span class="params">el</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                            el.innerHTML = value;</span></span><br><span class="line"><span class="javascript">                            el.value = value;</span></span><br><span class="line"><span class="javascript">                        &#125;);</span></span><br><span class="line"><span class="javascript">                &#125;</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">            <span class="comment">//初始化绑定元素事件</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.run = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">const</span> els = <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;[v-model]&quot;</span>);</span></span><br><span class="line"><span class="javascript">                els.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    item.addEventListener(<span class="string">&quot;keyup&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                        proxy[<span class="built_in">this</span>.getAttribute(<span class="string">&quot;v-model&quot;</span>)] = <span class="built_in">this</span>.value;</span></span><br><span class="line"><span class="javascript">                    &#125;);</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> view = <span class="keyword">new</span> View().run();</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="表单验证"><a href="#表单验证" class="headerlink" title="表单验证"></a>表单验证</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="number">#34495e</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">input</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: solid <span class="number">10px</span> <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.error</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: solid <span class="number">10px</span> red;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">validate</span> <span class="attr">rule</span>=<span class="string">&quot;max:12,min:3&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">validate</span> <span class="attr">rule</span>=<span class="string">&quot;max:3,isNumber&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="javascript">        &quot;use strict&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//验证处理类</span></span></span><br><span class="line"><span class="javascript">        <span class="class"><span class="keyword">class</span> <span class="title">Validate</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">max</span>(<span class="params">value, len</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> value.length &lt;= len;</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">min</span>(<span class="params">value, len</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> value.length &gt;= len;</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">isNumber</span>(<span class="params">value</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="regexp">/^\d+$/</span>.test(value);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">//代理工厂</span></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">makeProxy</span>(<span class="params">target</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</span></span><br><span class="line"><span class="javascript">                <span class="function"><span class="title">get</span>(<span class="params">target, key</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> target[key];</span></span><br><span class="line"><span class="javascript">                &#125;,</span></span><br><span class="line"><span class="javascript">                <span class="function"><span class="title">set</span>(<span class="params">target, key, el</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">const</span> rule = el.getAttribute(<span class="string">&quot;rule&quot;</span>);</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">const</span> validate = <span class="keyword">new</span> Validate();</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">let</span> state = rule.split(<span class="string">&quot;,&quot;</span>).every(<span class="function"><span class="params">rule</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">const</span> info = rule.split(<span class="string">&quot;:&quot;</span>);</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">return</span> validate[info[<span class="number">0</span>]](el.value, info[<span class="number">1</span>]);</span></span><br><span class="line"><span class="javascript">                    &#125;);</span></span><br><span class="line"><span class="javascript">                    el.classList[state ? <span class="string">&quot;remove&quot;</span> : <span class="string">&quot;add&quot;</span>](<span class="string">&quot;error&quot;</span>);</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">                &#125;</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> nodes = makeProxy(<span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;[validate]&quot;</span>));</span></span><br><span class="line"><span class="javascript">        nodes.forEach(<span class="function">(<span class="params">item, i</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            item.addEventListener(<span class="string">&quot;keyup&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                nodes[i] = <span class="built_in">this</span>;</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h1><h2 id="常见API-1"><a href="#常见API-1" class="headerlink" title="常见API"></a>常见API</h2><h3 id="entries"><a href="#entries" class="headerlink" title="entries"></a>entries</h3><p>常与<code>for...of</code>搭配进行<strong>数组遍历</strong>，重点是可以<strong>同时直接获取</strong>到<strong>数组的索引</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> arr.entries()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [0, &quot;a&quot;]</span></span><br><span class="line"><span class="comment">// [1, &quot;b&quot;]</span></span><br><span class="line"><span class="comment">// [2, &quot;c&quot;]</span></span><br></pre></td></tr></table></figure>

<h3 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h3><blockquote>
<p>接收三个参数，分别为当前条目、当前条目所处索引、操作的数组</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a.forEach(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item, index, arr);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h3><p>如果没有指定<code>initialValue</code>值，则循环<code>arr.length-1</code>次，否则循环<code>arr.length</code>次</p>
<ul>
<li><code>previousValue</code>：上一次调用 <code>callbackFn</code> 时的<strong>返回值</strong>，假如回调函数没有返回值，那么此时值为undefined，第一次除外。在第一次调用时，若指定了初始值 <code>initialValue</code>，其值则为 <code>initialValue</code>，否则为数组索引为 0 的元素 <code>array[0]</code>。</li>
<li><code>currentValue</code>：数组中正在处理的元素。在第一次调用时，若指定了初始值 <code>initialValue</code>，其值则为数组索引为 0 的元素 <code>array[0]</code>，否则为 <code>array[1]</code>。</li>
<li><code>currentIndex</code>：数组中正在处理的元素的索引。若指定了初始值 <code>initialValue</code>，则起始索引号为 0，否则从索引 1 起始。</li>
<li><code>array</code>：用于遍历的数组。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">//求和</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_sum</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(<span class="function">(<span class="params">pre, cur</span>) =&gt;</span> pre + cur, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//求最大值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_max</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(<span class="function">(<span class="params">pre, cur</span>) =&gt;</span> pre &gt; cur ? pre : cur)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//求某成员出现次数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_count</span>(<span class="params">arr, num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(<span class="function">(<span class="params">pre, cur</span>) =&gt;</span> pre += cur === num ? <span class="number">1</span> : <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(_sum(arr)); <span class="comment">//28</span></span><br><span class="line"><span class="built_in">console</span>.log(_max(arr)); <span class="comment">//8</span></span><br><span class="line"><span class="built_in">console</span>.log(_count(arr, <span class="number">1</span>)); <span class="comment">//3</span></span><br></pre></td></tr></table></figure>



<h1 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h1><p>Map是一组键值对的结构，<strong>用于解决</strong>以往<strong>不能用对象做为键</strong>的问题</p>
<ul>
<li>具有极快的查找速度</li>
<li>函数、对象、基本类型都可以作为键或值</li>
</ul>
<h2 id="1-声明定义"><a href="#1-声明定义" class="headerlink" title="1. 声明定义"></a>1. 声明定义</h2><p>可以接受一个数组作为参数，该数组的<strong>成员是</strong>一个<strong>表示键值对的数组</strong>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">18</span>]</span><br><span class="line">])</span><br><span class="line">map.get(<span class="string">&#x27;name&#x27;</span>) <span class="comment">//张三疯</span></span><br></pre></td></tr></table></figure>

<p>使用<code>set</code> 方法添加元素，支持链式操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;张三疯&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">map.set(obj, <span class="string">&quot;太极&quot;</span>).set(<span class="string">&quot;address&quot;</span>, <span class="string">&quot;武当&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(map); <span class="comment">// Map(2) &#123;&#123;…&#125; =&gt; &#x27;太极&#x27;, &#x27;address&#x27; =&gt; &#x27;武当&#x27;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(map.entries()); <span class="comment">//MapIterator &#123;&#123;…&#125; =&gt; &quot;houdunren.com&quot;, &quot;name&quot; =&gt; &quot;hdcms&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<p>使用构造函数<code>new Map</code>创建的原理如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="keyword">const</span> arr = [</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;age&quot;</span>, <span class="string">&quot;128&quot;</span>]</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">arr.forEach(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> &#123;</span><br><span class="line">    map.set(key, value);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(map);</span><br></pre></td></tr></table></figure>

<p>对于键是对象的<code>Map</code>， 键保存的是内存地址，值相同但内存地址不同的视为两个键。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;张三疯&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">map.set(arr, <span class="number">118</span>);</span><br><span class="line"><span class="built_in">console</span>.log(map.get(arr)); <span class="comment">//118</span></span><br><span class="line"><span class="comment">//这里get中的[&#x27;张三疯&#x27;] 内存地址和arr不一样</span></span><br><span class="line"><span class="built_in">console</span>.log(map.get([<span class="string">&quot;张三疯&quot;</span>])); <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure>

<h2 id="2-获取数量"><a href="#2-获取数量" class="headerlink" title="2. 获取数量"></a>2. 获取数量</h2><blockquote>
<p>map.size，size为属性</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line">map.set(<span class="string">&#x27;address&#x27;</span>, <span class="string">&#x27;武当&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(map.size); <span class="comment">//3</span></span><br></pre></td></tr></table></figure>

<h2 id="3-元素检测"><a href="#3-元素检测" class="headerlink" title="3. 元素检测"></a>3. 元素检测</h2><blockquote>
<p>map.has(key)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line"><span class="built_in">console</span>.log(map.has(<span class="string">&#x27;name&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="4-获取元素"><a href="#4-获取元素" class="headerlink" title="4. 获取元素"></a>4. 获取元素</h2><blockquote>
<p>map.get(key)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line"><span class="built_in">console</span>.log(map.has(<span class="string">&#x27;name&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="5-删除元素"><a href="#5-删除元素" class="headerlink" title="5. 删除元素"></a>5. 删除元素</h2><p>根据键值删除元素</p>
<blockquote>
<p>map.delete(key)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line"><span class="built_in">console</span>.log(map.delete(<span class="string">&#x27;name&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>删除所有元素</p>
<blockquote>
<p>map.clear()</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line"><span class="built_in">console</span>.log(map.size) <span class="comment">//2</span></span><br><span class="line">map.clear()</span><br><span class="line"><span class="built_in">console</span>.log(map.size); <span class="comment">//0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="6-遍历数据"><a href="#6-遍历数据" class="headerlink" title="6. 遍历数据"></a>6. 遍历数据</h2><blockquote>
<p>使用keys()、values()、entries() 都可以返回可遍历的迭代对象</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line"><span class="built_in">console</span>.log(map.keys()); <span class="comment">//MapIterator &#123;&#x27;name&#x27;, &#x27;age&#x27;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(map.values()); <span class="comment">//MapIterator &#123;&#x27;张三疯&#x27;, 118&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(map.entries()); <span class="comment">//MapIterator &#123;&#x27;name&#x27; =&gt; &#x27;张三疯&#x27;, &#x27;age&#x27; =&gt; 118&#125;</span></span><br></pre></td></tr></table></figure>

<p>可以使用keys()和values()函数分别遍历键与值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> map.keys()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> value <span class="keyword">of</span> map.values()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> value <span class="keyword">of</span> map.entries()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125; <span class="comment">//[&#x27;name&#x27;, &#x27;张三疯&#x27;]、[&#x27;age&#x27;, 118]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用<code>for...of</code>进行遍历Map相当于使用entries()函数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> map) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;<span class="comment">//[&#x27;name&#x27;, &#x27;张三疯&#x27;]、[&#x27;age&#x27;, 118]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用<code>forEach</code>遍历操作【此时的第一个参数为value，第二个参数为key】</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line">map.forEach(<span class="function">(<span class="params">value, key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key, value);</span><br><span class="line">&#125;)<span class="comment">//name,张三疯、 age,118</span></span><br></pre></td></tr></table></figure>

<h2 id="7-数组转换"><a href="#7-数组转换" class="headerlink" title="7. 数组转换"></a>7. 数组转换</h2><blockquote>
<p>可以使用<code>展开语法</code> 将Map类型转为数组</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三疯&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">118</span>]</span><br><span class="line">])</span><br><span class="line"><span class="built_in">console</span>.log([...map.values()]); <span class="comment">//[&#x27;张三疯&#x27;,118]</span></span><br><span class="line"><span class="built_in">console</span>.log([...map.keys()]); <span class="comment">//[&#x27;name&#x27;,&#x27;age&#x27;]</span></span><br><span class="line"><span class="built_in">console</span>.log(...map); <span class="comment">// [&quot;name&quot;, &quot;张三疯&quot;], [&#x27;age&#x27;, 118]</span></span><br><span class="line"><span class="built_in">console</span>.log(...map.keys()); <span class="comment">//name age</span></span><br></pre></td></tr></table></figure>

<p>检索值长度大于2组成新的Map</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>],</span><br><span class="line">    [<span class="string">&#x27;age&#x27;</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="string">&quot;alias&quot;</span>, <span class="string">&quot;刘三姐&quot;</span>]</span><br><span class="line">])</span><br><span class="line"><span class="keyword">let</span> newArr = [...map].filter(<span class="function"><span class="params">item</span> =&gt;</span> item[<span class="number">1</span>].length &gt; <span class="number">2</span>)</span><br><span class="line">map=<span class="keyword">new</span> <span class="built_in">Map</span>(newArr)</span><br><span class="line"><span class="built_in">console</span>.log(newArr);</span><br></pre></td></tr></table></figure>

<h2 id="8-节点集合"><a href="#8-节点集合" class="headerlink" title="8. 节点集合"></a>8. 节点集合</h2><p>map的key可以为任意类型，下面使用DOM节点做为键来记录数据。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;NB&quot;</span>&gt;</span>zsh<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;强&quot;</span>&gt;</span>crazyzsh<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> divs = <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;div&quot;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> divMap = <span class="keyword">new</span> <span class="built_in">Map</span>();</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 将desc属性值压入新创建的divMap中</span></span></span><br><span class="line"><span class="javascript">        divs.forEach(<span class="function"><span class="params">div</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            divMap.set(div, &#123;</span></span><br><span class="line"><span class="javascript">                <span class="attr">content</span>: div.getAttribute(<span class="string">&quot;desc&quot;</span>)</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">        divMap.forEach(<span class="function">(<span class="params">value, key</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            key.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                alert(divMap.get(<span class="built_in">this</span>).content);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="9-实例操作"><a href="#9-实例操作" class="headerlink" title="9. 实例操作"></a>9. 实例操作</h2><p>当不接受协议时无法提交表单，并根据自定义信息提示用户。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;&quot;</span> onsubmit=<span class="string">&quot; post()&quot;</span>&gt;</span><br><span class="line">    接受协议:</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;agreement&quot;</span> <span class="attr">message</span>=<span class="string">&quot;请接受接受协议&quot;</span> /&gt;</span></span></span><br><span class="line">    我是学生:</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;student&quot;</span> <span class="attr">message</span>=<span class="string">&quot;网站只对学生开放&quot;</span> /&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span></span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="keyword">function</span> <span class="title">post</span>(<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">let</span> inputs = <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;[message]&quot;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//使用set设置数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        inputs.forEach(<span class="function"><span class="params">item</span> =&gt;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            map.set(item, &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">message</span>: item.getAttribute(<span class="string">&quot;message&quot;</span>),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">status</span>: item.checked</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        );</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//遍历Map数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">return</span> [...map].every(<span class="function">(<span class="params">[item, config]</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            config.status || alert(config.message);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">return</span> config.status;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h1><h2 id="1-定义"><a href="#1-定义" class="headerlink" title="1. 定义"></a>1. 定义</h2><p><strong>WeakMap</strong> 对象是一组键/值对的集</p>
<ul>
<li><p><strong>键名</strong>必须是<strong>对象</strong></p>
</li>
<li><p>WeaMap对键名是弱引用的，键值是正常引用</p>
</li>
<li><p>垃圾回收不考虑WeaMap的键名，不会改变引用计数器，键在其他地方不被引用时即删除</p>
</li>
<li><p>因为WeakMap 是弱引用，由于其他地方操作成员可能会不存在，所以不可以进行<code>forEach( )</code>遍历等操作</p>
</li>
<li><p>也是因为弱引用，WeaMap 结构没有keys( )，values( )，entries( )等方法和 size 属性</p>
</li>
</ul>
<h2 id="2-使用场景"><a href="#2-使用场景" class="headerlink" title="2. 使用场景"></a>2. 使用场景</h2><ul>
<li>当键的外部引用删除时，希望自动删除数据时使用 <code>WeakMap</code></li>
</ul>
<h2 id="3-声明定义"><a href="#3-声明定义" class="headerlink" title="3. 声明定义"></a>3. 声明定义</h2><p>将DOM节点保存到<code>WeakSet</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>zsh<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>crazyzsh<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> weak = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span></span></span><br><span class="line"><span class="javascript">            .querySelectorAll(<span class="string">&quot;div&quot;</span>)</span></span><br><span class="line"><span class="javascript">            .forEach(<span class="function"><span class="params">item</span> =&gt;</span> weak.set(item, item.innerHTML));</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(weak); <span class="comment">//WeakMap &#123;div =&gt; &quot;zsh&quot;, div =&gt; &quot;crazyzsh&quot;&#125;</span></span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-基本操作"><a href="#4-基本操作" class="headerlink" title="4. 基本操作"></a>4. 基本操作</h2><p>除了不能使用keys( )，values( )，entries( )等方法和 size 属性，其余与Map一致</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>zsh<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>crazyzsh<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> weak = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> arr = [<span class="string">&quot;zsh&quot;</span>, <span class="string">&quot;crazyzsh&quot;</span>];</span></span><br><span class="line"><span class="javascript">        <span class="comment">//添加操作</span></span></span><br><span class="line"><span class="javascript">        weak.set(arr, <span class="string">&quot;NB&quot;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(weak.has(arr)); <span class="comment">//true</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">//删除操作</span></span></span><br><span class="line"><span class="javascript">        weak.delete(arr);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">//检索判断</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(weak.has(arr)); <span class="comment">//false</span></span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="5-垃圾回收"><a href="#5-垃圾回收" class="headerlink" title="5. 垃圾回收"></a>5. 垃圾回收</h2><p>WakeMap的键名对象<strong>不会增加引用</strong>计数器，如果一个对象不被引用了会自动删除。</p>
<ul>
<li>下例当<code>zsh</code>删除时内存即清除，因为WeakMap是弱引用不会产生引用计数，此时虽然可以打印值，但是<strong>键已经为空</strong>了</li>
<li>当<strong>垃圾回收</strong>时因为对象被删除，这时WakeMap也就<strong>没有记录</strong>了</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> weak = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> zsh = &#123;&#125;;</span></span><br><span class="line"><span class="javascript">    weak.set(zsh, <span class="string">&quot;crazyzsh&quot;</span>);</span></span><br><span class="line"><span class="javascript">    zsh = <span class="literal">null</span>;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(weak);<span class="comment">//WeakMap &#123;&#123;…&#125; =&gt; &#x27;crazyzsh&#x27;&#125;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(weak);<span class="comment">//WeakMap &#123;&#125;</span></span></span><br><span class="line"><span class="javascript">    &#125;, <span class="number">1000</span>);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-选课案例"><a href="#6-选课案例" class="headerlink" title="6. 选课案例"></a>6. 选课案例</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        * &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">            <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: solid <span class="number">2px</span> <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">div</span><span class="selector-pseudo">:last-of-type</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-left</span>: -<span class="number">2px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">list-style</span>: none;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: solid <span class="number">2px</span> <span class="number">#e67e22</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">            <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">            <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding-left</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">transition</span>: <span class="number">1s</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="number">#16a085</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="css">            <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">            <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-right</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.remove</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: solid <span class="number">2px</span> <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">opacity</span>: <span class="number">0.8</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.remove</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">p</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="number">#16a085</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>php<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>js<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>python<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">strong</span> <span class="attr">id</span>=<span class="string">&quot;count&quot;</span>&gt;</span>共选了2门课<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;lists&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="class"><span class="keyword">class</span> <span class="title">Lesson</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.lis = <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;ul&gt;li&quot;</span>);</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.countELem = <span class="built_in">document</span>.getElementById(<span class="string">&quot;count&quot;</span>);</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.listElem = <span class="built_in">document</span>.getElementById(<span class="string">&quot;lists&quot;</span>);</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">run</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.lis.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    item.querySelector(<span class="string">&quot;a&quot;</span>).addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">const</span> elem = event.target;</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">const</span> state = elem.getAttribute(<span class="string">&quot;select&quot;</span>);</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">if</span> (state) &#123;</span></span><br><span class="line"><span class="javascript">                            elem.removeAttribute(<span class="string">&quot;select&quot;</span>);</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">this</span>.map.delete(elem.parentElement);</span></span><br><span class="line"><span class="javascript">                            elem.innerHTML = <span class="string">&quot;+&quot;</span>;</span></span><br><span class="line"><span class="javascript">                            elem.style.backgroundColor = <span class="string">&quot;green&quot;</span>;</span></span><br><span class="line"><span class="javascript">                        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                            elem.setAttribute(<span class="string">&quot;select&quot;</span>, <span class="literal">true</span>);</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">this</span>.map.set(elem.parentElement, <span class="literal">true</span>);</span></span><br><span class="line"><span class="javascript">                            elem.innerHTML = <span class="string">&quot;-&quot;</span>;</span></span><br><span class="line"><span class="javascript">                            elem.style.backgroundColor = <span class="string">&quot;red&quot;</span>;</span></span><br><span class="line"><span class="javascript">                        &#125;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">this</span>.render();</span></span><br><span class="line"><span class="javascript">                    &#125;);</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">count</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> [...this.lis].reduce(<span class="function">(<span class="params">count, item</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> (count += <span class="built_in">this</span>.map.has(item) ? <span class="number">1</span> : <span class="number">0</span>);</span></span><br><span class="line"><span class="javascript">                &#125;, <span class="number">0</span>);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">lists</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> [...this.lis]</span></span><br><span class="line"><span class="javascript">                    .filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">return</span> <span class="built_in">this</span>.map.has(item);</span></span><br><span class="line"><span class="javascript">                    &#125;)</span></span><br><span class="line"><span class="javascript">                    .map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">return</span> <span class="string">`&lt;span&gt;<span class="subst">$&#123;item.querySelector(<span class="string">&quot;span&quot;</span>).innerHTML&#125;</span>&lt;/span&gt;`</span>;</span></span><br><span class="line"><span class="javascript">                    &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.countELem.innerHTML = <span class="string">`共选了<span class="subst">$&#123;<span class="built_in">this</span>.count()&#125;</span>课`</span>;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.listElem.innerHTML = <span class="built_in">this</span>.lists().join(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">new</span> Lesson().run();</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h1><p>用于存储任何类型的<strong>唯一值</strong>，无论是基本类型还是对象引用。</p>
<ul>
<li><strong>只能保存值</strong>没有键名</li>
<li>严格类型检测如<strong>字符串</strong>数字不等于<strong>数值型</strong>数字</li>
<li>值是<strong>唯一</strong>的</li>
<li>遍历顺序是添加的顺序，方便保存回调函数</li>
</ul>
<h2 id="1-背景"><a href="#1-背景" class="headerlink" title="1. 背景"></a>1. 背景</h2><p>对象的<strong>键</strong>最终都会转为<strong>字符串</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="number">1</span>: <span class="string">&quot;zsh&quot;</span>,</span><br><span class="line">    <span class="string">&quot;1&quot;</span>: <span class="string">&quot;crazy&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.table(obj); <span class="comment">//&#123;1:&quot;zsh&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<p>使用对象做为键名时，会将对象转为字符串后使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="number">1</span>: <span class="string">&quot;zsh&quot;</span>,</span><br><span class="line">    <span class="string">&quot;1&quot;</span>: <span class="string">&quot;crazy&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> crazyzsh = &#123;</span><br><span class="line">    [obj]: <span class="string">&quot;NB&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(crazyzsh);</span><br><span class="line"><span class="comment">//将对象转换成字符串后 当键名 来使用</span></span><br><span class="line"><span class="built_in">console</span>.log(crazyzsh[obj.toString()]);</span><br><span class="line"><span class="built_in">console</span>.log(crazyzsh[<span class="string">&quot;[object Object]&quot;</span>]);</span><br></pre></td></tr></table></figure>

<h2 id="2-添加元素"><a href="#2-添加元素" class="headerlink" title="2. 添加元素"></a>2. 添加元素</h2><p>使用数组做初始数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;zsh&#x27;</span>])</span><br><span class="line"><span class="built_in">console</span>.log(set); <span class="comment">//Set(2) &#123;&#x27;crazy&#x27;, &#x27;zsh&#x27;&#125;</span></span><br></pre></td></tr></table></figure>

<p>Set 中是严格类型约束的，下面的数值<code>1</code>与字符串<code>&quot;1&quot;</code>属于两个不同的值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>()</span><br><span class="line">set.add(<span class="number">1</span>);</span><br><span class="line">set.add(<span class="string">&quot;1&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(set); <span class="comment">//Set(2) &#123;1, &quot;1&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<p>使用 <code>add</code> 添加元素，重复添加相同值是无效的</p>
<h2 id="3-获取数量"><a href="#3-获取数量" class="headerlink" title="3. 获取数量"></a>3. 获取数量</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;zsh&#x27;</span>])</span><br><span class="line"><span class="built_in">console</span>.log(set.size); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<h2 id="4-元素检测"><a href="#4-元素检测" class="headerlink" title="4. 元素检测"></a>4. 元素检测</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;zsh&#x27;</span>])</span><br><span class="line"><span class="built_in">console</span>.log(set.has(<span class="string">&#x27;zsh&#x27;</span>)); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<h2 id="5-删除元素-1"><a href="#5-删除元素-1" class="headerlink" title="5. 删除元素"></a>5. 删除元素</h2><p>使用 <code>delete</code> 删除单个元素，删除成功返回真，否则为假</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;zsh&#x27;</span>])</span><br><span class="line"><span class="built_in">console</span>.log(set.delete(<span class="string">&#x27;zsh&#x27;</span>)); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>使用 <code>clear</code> 删除所有元素，没有返回值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;zsh&#x27;</span>])</span><br><span class="line">set.clear()</span><br><span class="line"><span class="built_in">console</span>.log(set); <span class="comment">//Set(0) &#123;size: 0&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-数组转换"><a href="#6-数组转换" class="headerlink" title="6. 数组转换"></a>6. 数组转换</h2><p>可以使用<code>点语法</code> 或 <code>Array.form</code> 静态方法将Set类型转为数组，这样就可以使用数组处理函数了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;zsh&#x27;</span>])</span><br><span class="line"><span class="built_in">console</span>.log([...set]); <span class="comment">//[&#x27;crazy&#x27;, &#x27;zsh&#x27;]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(set)); <span class="comment">//[&#x27;crazy&#x27;, &#x27;zsh&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>移除set中大于5的值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//一般是传数组的，当传入 单个字符串 的话就会将其转换成Set</span></span><br><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>(<span class="string">&quot;123456789&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(set); <span class="comment">//Set(9) &#123;&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, …&#125;</span></span><br><span class="line"></span><br><span class="line">set = <span class="keyword">new</span> <span class="built_in">Set</span>([...set].filter(<span class="function"><span class="params">item</span> =&gt;</span> item &lt; <span class="number">5</span>));</span><br><span class="line"><span class="built_in">console</span>.log(set); <span class="comment">//Set(4) &#123;&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="7-去重"><a href="#7-去重" class="headerlink" title="7. 去重"></a>7. 去重</h2><p>去除字符串重复</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>(<span class="string">&quot;hello&quot;</span>); <span class="comment">//此刻已经进行了去重</span></span><br><span class="line"><span class="built_in">console</span>.log([...set].join(<span class="string">&#x27;&#x27;</span>)); <span class="comment">//helo</span></span><br></pre></td></tr></table></figure>

<p>去除数组重复</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr = [...new <span class="built_in">Set</span>(arr)]</span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// 1,2,4,5</span></span><br></pre></td></tr></table></figure>

<h2 id="8-遍历数据"><a href="#8-遍历数据" class="headerlink" title="8. 遍历数据"></a>8. 遍历数据</h2><p>使用 <code>keys()/values()/entries()</code> 都可以返回迭代对象，因为<code>set</code>类型只有值所以 <code>keys与values</code> 方法结果一致。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&quot;zsh&quot;</span>, <span class="string">&quot;crazyzsh&quot;</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(hd.values()); <span class="comment">//SetIterator &#123;&quot;zsh&quot;, &quot;crazyzsh&quot;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(hd.keys()); <span class="comment">//SetIterator &#123;&quot;zsh&quot;, &quot;crazyzsh&quot;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(hd.entries()); <span class="comment">//SetIterator &#123;&quot;zsh&quot; =&gt; &quot;zsh&quot;, &quot;crazyzsh&quot; =&gt; &quot;crazyzsh&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<p>可以使用 <code>forEach</code> 遍历Set数据，默认使用 <code>values</code> 方法创建迭代器。</p>
<p>为了保持和遍历数组参数统一，函数中的value与key是一样的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">7</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>(arr);</span><br><span class="line"><span class="comment">//使用forEach遍历【item、key值一致】</span></span><br><span class="line">set.forEach(<span class="function">(<span class="params">item,key</span>) =&gt;</span> <span class="built_in">console</span>.log(item,key));</span><br></pre></td></tr></table></figure>

<p>也可以使用 <code>for...of</code> 遍历Set数据，默认使用 <code>values</code> 方法创建迭代器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用for...of遍历</span></span><br><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">7</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">6</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> iterator <span class="keyword">of</span> set) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(iterator);<span class="comment">//7 6 2 8 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-搜索实例"><a href="#9-搜索实例" class="headerlink" title="9. 搜索实例"></a>9. 搜索实例</h2><p>利用Set特性将搜索关键字进行保存并显示在历史记录中</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">words</span>: <span class="keyword">new</span> <span class="built_in">Set</span>(),</span></span><br><span class="line"><span class="javascript">        <span class="keyword">set</span> <span class="title">keyword</span>(<span class="params">word</span>) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.words.add(word);</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">show</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> ul = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;ul&#x27;</span>);</span></span><br><span class="line"><span class="javascript">            ul.innerHTML = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.words.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                ul.innerHTML += (<span class="string">&#x27;&lt;li&gt;&#x27;</span> + item + <span class="string">&#x27;&lt;/li&gt;&#x27;</span>);</span></span><br><span class="line"><span class="javascript">            &#125;)</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.querySelector(<span class="string">&#x27;input&#x27;</span>).addEventListener(<span class="string">&#x27;keyup&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 按下enter键进行确定</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (event.keyCode == <span class="number">13</span>) &#123;</span></span><br><span class="line"><span class="javascript">            obj.keyword = <span class="built_in">this</span>.value;</span></span><br><span class="line"><span class="javascript">            obj.show();</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    &#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="10-交集"><a href="#10-交集" class="headerlink" title="10. 交集"></a>10. 交集</h2><p>获取两个集合中共同存在的元素</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set1 = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;zsh&#x27;</span>, <span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;crazyzsh&#x27;</span>]);</span><br><span class="line"><span class="keyword">let</span> set2 = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;NB&#x27;</span>]);</span><br><span class="line"><span class="keyword">let</span> newSet = <span class="keyword">new</span> <span class="built_in">Set</span>(</span><br><span class="line">    [...set1].filter(<span class="function"><span class="params">item</span> =&gt;</span> set2.has(item))</span><br><span class="line">);</span><br><span class="line"><span class="built_in">console</span>.log(newSet); <span class="comment">//&#123;&quot;crazy&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="11-差集"><a href="#11-差集" class="headerlink" title="11. 差集"></a>11. 差集</h2><p>在集合a中出现但不在集合b中出现元素集合</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;zsh&#x27;</span>, <span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;crazyzsh&#x27;</span>]);</span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;NB&#x27;</span>]);</span><br><span class="line"><span class="keyword">let</span> newSet = <span class="keyword">new</span> <span class="built_in">Set</span>(</span><br><span class="line">    [...a].filter(<span class="function"><span class="params">item</span> =&gt;</span> !b.has(item))</span><br><span class="line">);</span><br><span class="line"><span class="built_in">console</span>.log(newSet); <span class="comment">//&#123;&quot;zsh&quot;,&quot;crazyzsh&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="12-并集"><a href="#12-并集" class="headerlink" title="12. 并集"></a>12. 并集</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;zsh&#x27;</span>, <span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;crazyzsh&#x27;</span>]);</span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crazy&#x27;</span>, <span class="string">&#x27;NB&#x27;</span>]);</span><br><span class="line"><span class="keyword">let</span> newSet = <span class="keyword">new</span> <span class="built_in">Set</span>([...a, ...b]);</span><br><span class="line"><span class="built_in">console</span>.log(newSet); <span class="comment">//Set(4) &#123;&#x27;zsh&#x27;, &#x27;crazy&#x27;, &#x27;crazyzsh&#x27;, &#x27;NB&#x27;&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h1><p>WeakSet结构同样不会存储重复的值，它的成员必须<strong>只能</strong>是<strong>对象类型</strong>的值。</p>
<ul>
<li>垃圾回收不考虑WeakSet，即被WeakSet引用时引用计数器不加一，所以对象不被引用时不管WeakSet是否在使用都将删除</li>
<li>因为WeakSet 是弱引用，由于其他地方操作成员可能会不存在，所以<strong>不可以</strong>进行<code>forEach( )</code>遍历等操作</li>
<li>也是因为弱引用，WeakSet 结构<strong>没有</strong>keys( )，values( )，entries( )等方法和size属性</li>
</ul>
<h2 id="1-使用场景"><a href="#1-使用场景" class="headerlink" title="1. 使用场景"></a>1. 使用场景</h2><ul>
<li>因为是弱引用所以当外部引用删除时，希望自动删除数据时使用 <code>WeakMap</code></li>
</ul>
<h2 id="2-添加元素-1"><a href="#2-添加元素-1" class="headerlink" title="2. 添加元素"></a>2. 添加元素</h2><p>以下操作由于数据不是对象类型将产生错误</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">WeakSet</span>([<span class="string">&quot;zsh&quot;</span>, <span class="string">&quot;crazy&quot;</span>]); <span class="comment">//Invalid value used in weak set</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">WeakSet</span>(<span class="string">&quot;crazyzsh&quot;</span>); <span class="comment">//Invalid value used in weak set</span></span><br></pre></td></tr></table></figure>

<p>WeakSet的值必须为对象类型</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> weak = <span class="keyword">new</span> <span class="built_in">WeakSet</span>([</span><br><span class="line">    [<span class="string">&#x27;zsh&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;crazyzsh&#x27;</span>],</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">description</span>: <span class="string">&quot;NB&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(weak);</span><br></pre></td></tr></table></figure>

<p>将DOM节点保存到<code>WeakSet</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">name</span>=<span class="string">&quot;button1&quot;</span>&gt;</span>按钮1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">name</span>=<span class="string">&quot;button1&quot;</span>&gt;</span>按钮2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> buttons = <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;button&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> targetButtons = <span class="keyword">new</span> <span class="built_in">WeakSet</span>()</span></span><br><span class="line"><span class="javascript">        buttons.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            targetButtons.add(item)</span></span><br><span class="line"><span class="javascript">        &#125;)</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(targetButtons);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-基本操作"><a href="#3-基本操作" class="headerlink" title="3. 基本操作"></a>3. 基本操作</h2><p>除了size()、keys()、values()、entries()不能用之外，其余与Set一致，下面是WeakSet的常用指令</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> weak = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line"><span class="keyword">const</span> arr = [<span class="string">&quot;zsh&quot;</span>];</span><br><span class="line"><span class="comment">//添加操作</span></span><br><span class="line">weak.add(arr);</span><br><span class="line"><span class="built_in">console</span>.log(weak.has(arr));</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除操作</span></span><br><span class="line">weak.delete(arr);</span><br><span class="line"></span><br><span class="line"><span class="comment">//检索判断</span></span><br><span class="line"><span class="built_in">console</span>.log(weak.has(arr));</span><br></pre></td></tr></table></figure>

<h2 id="4-垃圾回收"><a href="#4-垃圾回收" class="headerlink" title="4. 垃圾回收"></a>4. 垃圾回收</h2><p>WeaSet保存的对象<strong>不会增加</strong>引用计数器，如果一个对象不被引用了会自动删除。</p>
<ul>
<li>下例中的数组被 <code>arr</code> 引用了，引用计数器+1</li>
<li>数据又添加到了 weak 中，引用计数还是1</li>
<li>当 <code>arr</code> 设置为null时，引用计数-1 此时对象引用为0</li>
<li>当垃圾回收时对象被删除，这时weak也就没有记录了</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> weak = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&quot;crazyzsh&quot;</span>];</span><br><span class="line">weak.add(arr);</span><br><span class="line"><span class="built_in">console</span>.log(weak.has(arr)); <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">arr = <span class="literal">null</span>;</span><br><span class="line"><span class="built_in">console</span>.log(weak); <span class="comment">//WeakSet &#123;Array(1)&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(weak); <span class="comment">//WeakSet &#123;&#125;</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<h2 id="5-案例操作"><a href="#5-案例操作" class="headerlink" title="5. 案例操作"></a>5. 案例操作</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        * &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">list-style</span>: none;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: solid <span class="number">2px</span> <span class="number">#e67e22</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">            <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">            <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding-left</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">transition</span>: <span class="number">1s</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="number">#16a085</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="css">            <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">            <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-right</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.remove</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: solid <span class="number">2px</span> <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">opacity</span>: <span class="number">0.8</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.remove</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>crazy<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span>&gt;</span>x<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>zsh <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span>&gt;</span>x<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>crazyzsh<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span>&gt;</span>x<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="class"><span class="keyword">class</span> <span class="title">Todos</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;&#125;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">run</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.items = <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;ul&gt;li&quot;</span>);</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.lists = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.record();</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.addEvent();</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">addEvent</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.items.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                item.querySelector(<span class="string">&quot;a&quot;</span>).addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">//检测WakeSet中是否存在Li元素【event.target.parentElement为点击的a元素的父元素li】</span></span></span><br><span class="line"><span class="javascript">                    <span class="keyword">const</span> parentElement = event.target.parentElement;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">if</span> (!<span class="built_in">this</span>.lists.has(parentElement)) &#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&quot;已经删除此TODO&quot;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                        <span class="comment">//删除后从记录的WakeSet中移除</span></span></span><br><span class="line"><span class="javascript">                        parentElement.classList.add(<span class="string">&quot;remove&quot;</span>);</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">this</span>.lists.delete(parentElement);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">record</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.items.forEach(<span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">this</span>.lists.add(item));</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> Todos().run();</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h1><h2 id="this"><a href="#this" class="headerlink" title="this"></a>this</h2><h3 id="普通函数"><a href="#普通函数" class="headerlink" title="普通函数"></a>普通函数</h3><ul>
<li>构造函数（类）：this指向实例出来的对象</li>
<li>以函数的形式调用时，this永远都是window</li>
<li>以方法的形式进行调用，this就是调用方法的那个对象</li>
</ul>
<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><p>箭头函数没有<code>this</code>, 也可以理解为箭头函数中的<code>this</code> 会继承定义函数时的上下文，可以理解为<strong>和外层函数（作用域）</strong>指向<strong>同一个this</strong>。</p>
<ul>
<li>如果想使用函数定义时的上下文中的this，那就使用箭头函数</li>
<li>本着新特性的原则，尽量使用箭头函数（还是得视情况而定）</li>
<li>事件函数可理解为对象<code>onclick</code>设置值，所以函数声明时<code>this</code>为当前对象</li>
</ul>
<h3 id="例题分析"><a href="#例题分析" class="headerlink" title="例题分析"></a>例题分析</h3><h4 id="例1【混合】"><a href="#例1【混合】" class="headerlink" title="例1【混合】"></a>例1【混合】</h4><p>由于直接返回的是一个函数，此时不应该将其当成方法来进行分析；返回的是一个箭头函数，得知其this应当指向定义时的上下文，此时箭头函数中的this指向的是方法sayName中的this，由于此时为对象中的方法为普通函数，就必须考虑是谁来调用的，此时的调用者为obj，所以打印出来的为对象中的name</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.sayName()() <span class="comment">//&#x27;zsh&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="例2【混合】"><a href="#例2【混合】" class="headerlink" title="例2【混合】"></a>例2【混合】</h4><p>返回的是一个箭头函数，得知其this应当指向定义时的上下文，此时箭头函数中的this指向的是方法sayName中的this，由于此时为对象中的方法为普通函数，就必须考虑是谁来调用的，此时的调用者为window，所以打印出来的为window中的name</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> temp = obj.sayName</span><br><span class="line">temp()() <span class="comment">//&#x27;张三疯&#x27;</span></span><br></pre></td></tr></table></figure>

<p>例1例2结论： 只要对象中的<strong>方法</strong>为<strong>普通函数</strong>，此时就必须关注是谁进行调用的</p>
<h4 id="例3【混合】"><a href="#例3【混合】" class="headerlink" title="例3【混合】"></a>例3【混合】</h4><p>返回出来的为函数，this指向的就是window</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.sayName()() <span class="comment">//&#x27;张三疯&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="例4【普通】"><a href="#例4【普通】" class="headerlink" title="例4【普通】"></a>例4【普通】</h4><p>由于直接返回的是一个函数，此时不应该将其当成方法来进行分析，返回的是普通函数，所以其this指向的就是window</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.sayName()() <span class="comment">//&#x27;张三疯&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="例5【普通】"><a href="#例5【普通】" class="headerlink" title="例5【普通】"></a>例5【普通】</h4><p>当方法的<strong>调用者</strong>为<strong>对象本身</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.sayName() <span class="comment">//&#x27;zsh&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="例6【普通】"><a href="#例6【普通】" class="headerlink" title="例6【普通】"></a>例6【普通】</h4><p>当方法的<strong>调用者</strong>为<strong>window</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.sayName() <span class="comment">//&#x27;zsh&#x27;</span></span><br><span class="line"><span class="keyword">let</span> temp = obj.sayName</span><br><span class="line">temp() <span class="comment">//&#x27;张三疯&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="例7【箭头】"><a href="#例7【箭头】" class="headerlink" title="例7【箭头】"></a>例7【箭头】</h4><p>由于箭头函数没有this指向，所以此时的this指向的是上一级作用域中的this【常见的话只有函数才能构成作用域，所以此时上一级作用域指的是定义该函数时的作用域】，又由于对象中的<code>&#123;&#125;</code>大括号不构成作用域，所以此时在箭头函数中的this指向的是window</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.sayName() <span class="comment">//&#x27;张三疯&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="例8【箭头】"><a href="#例8【箭头】" class="headerlink" title="例8【箭头】"></a>例8【箭头】</h4><p>当使用的是箭头函数时，就不用考虑到底是谁进行调用的，只需考虑其上一级作用域即可。只有在<strong>普通函数中</strong>才要<strong>注意</strong>函数的<strong>调用者</strong>是哪一个。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> temp = obj.sayName</span><br><span class="line">temp() <span class="comment">//&#x27;张三疯&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="例9【箭头】"><a href="#例9【箭头】" class="headerlink" title="例9【箭头】"></a>例9【箭头】</h4><p>从最里面的箭头函数分析，由于其是函数而并不是方法，其this指向定义时的上下文，即方法sayName，又由于sayName为箭头函数，其this指向的是window，所以此时的this指向的就是window</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;张三疯&#x27;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zsh&#x27;</span>,</span><br><span class="line">    <span class="attr">sayName</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.sayName()() <span class="comment">//&#x27;张三疯&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="例10"><a href="#例10" class="headerlink" title="例10"></a>例10</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> lesson = &#123;</span><br><span class="line">    <span class="attr">study</span>: <span class="string">&quot;i love&quot;</span>,</span><br><span class="line">    <span class="attr">lists</span>: [<span class="string">&quot;js&quot;</span>, <span class="string">&quot;css&quot;</span>, <span class="string">&quot;mysql&quot;</span>],</span><br><span class="line">    <span class="function"><span class="title">show</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.lists.map(<span class="function"><span class="params">title</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.study&#125;</span>:<span class="subst">$&#123;title&#125;</span>`</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(lesson.show()); <span class="comment">// [&#x27;i love:js&#x27;, &#x27;i love:css&#x27;, &#x27;i love:mysql&#x27;]</span></span><br></pre></td></tr></table></figure>

<h4 id="例11"><a href="#例11" class="headerlink" title="例11"></a>例11</h4><p>此时this位于普通函数中，所以指向的为window</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Lesson = &#123;</span><br><span class="line">    <span class="attr">study</span>: <span class="string">&quot;i love&quot;</span>,</span><br><span class="line">    <span class="attr">lists</span>: [<span class="string">&quot;js&quot;</span>, <span class="string">&quot;css&quot;</span>, <span class="string">&quot;mysql&quot;</span>],</span><br><span class="line">    <span class="function"><span class="title">show</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.lists.map(<span class="function"><span class="keyword">function</span> (<span class="params">title</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.study&#125;</span>:<span class="subst">$&#123;title&#125;</span>`</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(Lesson.show());<span class="comment">// [&#x27;undefined:js&#x27;, &#x27;undefined:css&#x27;, &#x27;undefined:mysql&#x27;]</span></span><br></pre></td></tr></table></figure>



<h4 id="例12"><a href="#例12" class="headerlink" title="例12"></a>例12</h4><p>数组中的map函数可以指定第二个参数，用于指定this的指向，此时传入的就是方法中的this，即对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> lesson = &#123;</span><br><span class="line">    <span class="attr">study</span>: <span class="string">&quot;i love&quot;</span>,</span><br><span class="line">    <span class="attr">lists</span>: [<span class="string">&quot;js&quot;</span>, <span class="string">&quot;css&quot;</span>, <span class="string">&quot;mysql&quot;</span>],</span><br><span class="line">    <span class="function"><span class="title">show</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.lists.map(<span class="function"><span class="keyword">function</span> (<span class="params">title</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.study&#125;</span>:<span class="subst">$&#123;title&#125;</span>`</span>;</span><br><span class="line">        &#125;, <span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(lesson.show());<span class="comment">// [&#x27;i love:js&#x27;, &#x27;i love:css&#x27;, &#x27;i love:mysql&#x27;]</span></span><br></pre></td></tr></table></figure>

<h4 id="例13"><a href="#例13" class="headerlink" title="例13"></a>例13</h4><p>在父作用域中定义引用<code>this</code>的变量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Lesson = &#123;</span><br><span class="line">    <span class="attr">study</span>: <span class="string">&quot;i love&quot;</span>,</span><br><span class="line">    <span class="attr">lists</span>: [<span class="string">&quot;js&quot;</span>, <span class="string">&quot;css&quot;</span>, <span class="string">&quot;mysql&quot;</span>],</span><br><span class="line">    <span class="function"><span class="title">show</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 使用变量将this进行保存</span></span><br><span class="line">        <span class="keyword">let</span> that = <span class="built_in">this</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.lists.map(<span class="function"><span class="keyword">function</span> (<span class="params">title</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;that.study&#125;</span>:<span class="subst">$&#123;title&#125;</span>`</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(Lesson.show()); <span class="comment">//[&#x27;i love:js&#x27;, &#x27;i love:css&#x27;, &#x27;i love:mysql&#x27;]</span></span><br></pre></td></tr></table></figure>

<h4 id="例14"><a href="#例14" class="headerlink" title="例14"></a>例14</h4><p>使用普通函数时<code>this</code>为当前DOM对象</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">desc</span>=<span class="string">&quot;this is a test&quot;</span>&gt;</span>button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> Dom = &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">name</span>: <span class="string">&quot;crazyzsh&quot;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">bind</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">const</span> button = <span class="built_in">document</span>.querySelector(<span class="string">&quot;button&quot;</span>);</span></span><br><span class="line"><span class="javascript">                button.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    alert(<span class="built_in">this</span>.getAttribute(<span class="string">&quot;desc&quot;</span>));</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;;</span></span><br><span class="line"><span class="javascript">        Dom.bind();</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="例15"><a href="#例15" class="headerlink" title="例15"></a>例15</h4><p>使用箭头函数时this指向上下文对象</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">desc</span>=<span class="string">&quot;test&quot;</span>&gt;</span>无敌是多么寂寞<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> Dom = &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">name</span>: <span class="string">&quot;crazyzsh&quot;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">bind</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">const</span> button = <span class="built_in">document</span>.querySelector(<span class="string">&quot;button&quot;</span>);</span></span><br><span class="line"><span class="javascript">                button.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    alert(<span class="built_in">this</span>.name + event.target.innerHTML);</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;;</span></span><br><span class="line"><span class="javascript">        Dom.bind();</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="例16"><a href="#例16" class="headerlink" title="例16"></a>例16</h4><p>使用<code>handleEvent</code>绑定事件处理器时，<code>this</code>指向当前对象而不是DOM元素。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">desc</span>=<span class="string">&quot;this is a test&quot;</span>&gt;</span>button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> Dom = &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">name</span>: <span class="string">&quot;crazyzsh&quot;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">handleEvent</span>: <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">//&#123;name: &#x27;crazyzsh&#x27;, handleEvent: ƒ, bind: ƒ&#125;</span></span></span><br><span class="line"><span class="javascript">            &#125;,</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">bind</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">const</span> button = <span class="built_in">document</span>.querySelector(<span class="string">&quot;button&quot;</span>);</span></span><br><span class="line"><span class="javascript">                button.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="built_in">this</span>);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;;</span></span><br><span class="line"><span class="javascript">        Dom.bind();</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h2><p>在某个时刻被其他函数调用的函数称为回调函数</p>
<ol>
<li>下面是一个常规的通过传入函数的形式来形成的一个回调函数的例子</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayName</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`我叫<span class="subst">$&#123;name&#125;</span>啊`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用回调函数，同时将参数传入回调函数中</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">introduction</span>(<span class="params">name, age, callback</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//此时进行调用，callback称为回调函数</span></span><br><span class="line">    callback(name)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`我今年<span class="subst">$&#123;age&#125;</span>岁了`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">introduction(<span class="string">&#x27;zsh&#x27;</span>, <span class="number">18</span>, sayName)<span class="comment">//我叫zsh  我今年18岁了</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>处理键盘、鼠标事件的函数</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&#x27;button&#x27;</span>&gt;</span>button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">     <span class="built_in">document</span>.getElementById(<span class="string">&#x27;button&#x27;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> alert(<span class="string">&#x27;通过回调函数调用&#x27;</span>));</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>使用回调函数递增计算</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function"><span class="params">item</span> =&gt;</span> item + <span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr)</span><br></pre></td></tr></table></figure>



<h2 id="closure"><a href="#closure" class="headerlink" title="closure"></a>closure</h2><h1 id="DOM常用API"><a href="#DOM常用API" class="headerlink" title="DOM常用API"></a>DOM常用API</h1><h2 id="className"><a href="#className" class="headerlink" title="className"></a>className</h2><p>设定类名</p>
<h2 id="classList"><a href="#classList" class="headerlink" title="classList"></a>classList</h2><h3 id="add"><a href="#add" class="headerlink" title="add"></a>add</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">div.className = <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始状态：&lt;div class=&quot;foo&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="built_in">console</span>.log(div.outerHTML);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 classList API 添加类值</span></span><br><span class="line">div.classList.add(<span class="string">&quot;anotherclass&quot;</span>);</span><br><span class="line"><span class="comment">// 添加多个类值</span></span><br><span class="line">div.classList.add(<span class="string">&quot;bar&quot;</span>, <span class="string">&quot;baz&quot;</span>);</span><br><span class="line"><span class="comment">// 使用展开语法添加多个类值</span></span><br><span class="line"><span class="keyword">const</span> cls = [<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>];</span><br><span class="line">div.classList.add(...cls);</span><br></pre></td></tr></table></figure>

<h3 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">div.className = <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始状态：&lt;div class=&quot;foo&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="built_in">console</span>.log(div.outerHTML);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 classList API 添加类值</span></span><br><span class="line">div.classList.remove(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line"><span class="comment">// 移除多个类值</span></span><br><span class="line">div.classList.remove(<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;baz&quot;</span>);</span><br><span class="line"><span class="comment">// 使用展开语法移除多个类值</span></span><br><span class="line"><span class="keyword">const</span> cls = [<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>];</span><br><span class="line">div.classList.remove(...cls);</span><br></pre></td></tr></table></figure>

<h3 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">div.className = <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line"><span class="comment">// 如果 visible 类值已存在，则移除它，否则添加它</span></span><br><span class="line">div.classList.toggle(<span class="string">&quot;visible&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="toggle"><a href="#toggle" class="headerlink" title="toggle"></a>toggle</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">div.className = <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line"><span class="comment">// 将类值 &quot;foo&quot; 替换成 &quot;bar&quot;</span></span><br><span class="line">div.classList.replace(<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="cookie-session"><a href="#cookie-session" class="headerlink" title="cookie/session"></a>cookie/session</h2><p>浏览器的缓存机制提供了可以将用户数据<strong>存储在客户端</strong>上的方式，可以利用cookie，session等<strong>跟服务端</strong>进行<strong>数据交互</strong>。</p>
<p>cookie和session都是用来跟踪浏览器用户身份的会话方式。</p>
<h3 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h3><h4 id="1、保持状态"><a href="#1、保持状态" class="headerlink" title="1、保持状态"></a>1、保持状态</h4><p>cookie保存在浏览器端，session保存在服务器端</p>
<h4 id="2、使用方式："><a href="#2、使用方式：" class="headerlink" title="2、使用方式："></a>2、使用方式：</h4><p>cookie机制：如果不在浏览器中设置过期时间，cookie被保存在内存中，生命周期随浏览器的关闭而结束，这种cookie简称会话cookie。如果在浏览器中设置了cookie的过期时间，cookie被保存在硬盘中，关闭浏览器后，cookie数据仍然存在，直到过期时间结束才消失。</p>
<p>Cookie是服务器发给客户端的特殊信息，cookie是以文本的方式保存在客户端，每次请求时都带上它</p>
<p>session机制：当服务器收到请求需要创建session对象时，首先会检查客户端请求中是否包含sessionid。如果有sessionid，服务器将根据该id返回对应session对象。如果客户端请求中没有sessionid，服务器会创建新的session对象，并把sessionid在本次响应中返回给客户端。通常使用cookie方式存储sessionid到客户端，在交互中浏览器按照规则将sessionid发送给服务器。如果用户禁用cookie，则要使用URL重写，可以通过response.encodeURL(url) 进行实现；API对encodeURL的结束为，当浏览器支持Cookie时，url不做任何处理；当浏览器不支持Cookie的时候，将会重写URL将SessionID拼接到访问地址后。</p>
<h4 id="3、存储内容："><a href="#3、存储内容：" class="headerlink" title="3、存储内容："></a>3、存储内容：</h4><p>cookie只能保存字符串类型，以文本的方式；session通过类似与Hashtable的数据结构来保存，能支持任何类型的对象(session中可含有多个对象)</p>
<h4 id="4、存储的大小："><a href="#4、存储的大小：" class="headerlink" title="4、存储的大小："></a>4、存储的大小：</h4><p>cookie：单个cookie保存的数据不能超过4kb；session大小没有限制。</p>
<h4 id="5、安全性："><a href="#5、安全性：" class="headerlink" title="5、安全性："></a>5、安全性：</h4><p>cookie：针对cookie所存在的攻击：Cookie欺骗，Cookie截获；session的安全性大于cookie。</p>
<p>原因如下：</p>
<p>（1）sessionID存储在cookie中，若要攻破session首先要攻破cookie；</p>
<p>（2）sessionID是要有人登录，或者启动session_start才会有，所以攻破cookie也不一定能得到sessionID；</p>
<p>（3）第二次启动session_start后，前一次的sessionID就是失效了，session过期后，sessionID也随之失效。</p>
<p>（4）sessionID是加密的</p>
<p>（5）综上所述，攻击者必须在短时间内攻破加密的sessionID，这很难。</p>
<h4 id="6、应用场景："><a href="#6、应用场景：" class="headerlink" title="6、应用场景："></a>6、应用场景：</h4><p>cookie：</p>
<p>（1）判断用户是否登陆过网站，以便下次登录时能够实现自动登录（或者记住密码）。如果我们删除cookie，则每次登录必须从新填写登录的相关信息。</p>
<p>（2）保存上次登录的时间等信息。</p>
<p>（3）保存上次查看的页面</p>
<p>（4）浏览计数</p>
<p><img src="https://raw.githubusercontent.com/crazyzsh/myImage/main/imageTest/202204021510199.png"></p>
<p>session：Session用于保存每个用户的专用信息，变量的值保存在服务器端，通过SessionID来区分不同的客户。</p>
<p>（1）网上商城中的购物车</p>
<p>（2）保存用户登录信息</p>
<p>（3）将某些数据放入session中，供同一用户的不同页面使用</p>
<p>（4）防止用户非法登录</p>
<h4 id="7、缺点："><a href="#7、缺点：" class="headerlink" title="7、缺点："></a>7、缺点：</h4><p>cookie：</p>
<p>（1）大小受限</p>
<p>（2）用户可以操作（禁用）cookie，使功能受限</p>
<p>（3）安全性较低</p>
<p>（4）有些状态不可能保存在客户端。</p>
<p>（5）每次访问都要传送cookie给服务器，浪费带宽。</p>
<p>（6）cookie数据有路径（path）的概念，可以限制cookie只属于某个路径下。</p>
<p> session：</p>
<p>（1）Session保存的东西越多，就越占用服务器内存，对于用户在线人数较多的网站，服务器的内存压力会比较大。</p>
<p>（2）依赖于cookie（sessionID保存在cookie），如果禁用cookie，则要使用URL重写，不安全</p>
<p>（3）创建Session变量有很大的随意性，可随时调用，不需要开发者做精确地处理，所以，过度使用session变量将会导致代码不可读而且不好维护。</p>
<h3 id="设置cookie"><a href="#设置cookie" class="headerlink" title="设置cookie"></a>设置cookie</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">&quot;name=oeschger&quot;</span>;</span><br><span class="line"><span class="built_in">document</span>.cookie = <span class="string">&quot;favorite_food=tripe&quot;</span>;</span><br><span class="line">alert(<span class="built_in">document</span>.cookie);</span><br><span class="line"><span class="comment">// 显示: name=oeschger;favorite_food=tripe</span></span><br></pre></td></tr></table></figure>

<h3 id="获取cookie"><a href="#获取cookie" class="headerlink" title="获取cookie"></a>获取cookie</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">&quot;test1=Hello&quot;</span>;</span><br><span class="line"><span class="built_in">document</span>.cookie = <span class="string">&quot;test2=World&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用正则表示进行获取</span></span><br><span class="line"><span class="keyword">var</span> myCookie = <span class="built_in">document</span>.cookie.replace(<span class="regexp">/(?:(?:^|.*;\s*)test2\s*\=\s*([^;]*).*$)|^.*$/</span>, <span class="string">&quot;$1&quot;</span>);</span><br><span class="line"></span><br><span class="line">alert(myCookie);<span class="comment">// 显示: World</span></span><br></pre></td></tr></table></figure>





<h2 id="WebStorage"><a href="#WebStorage" class="headerlink" title="WebStorage"></a>WebStorage</h2><h3 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h3><p>随着互联网的快速发展，基于网页的应用越来越普遍，同时也变得越来越复杂，为了满足各种各样的需求，会经常在本地存储大量的数据，HTML5规范提出了相关的解决方案。</p>
<p>本地存储特性</p>
<ul>
<li>数据存储在用户浏览器中</li>
<li>设置、读取方便，甚至页面刷新都不会丢失数据</li>
<li>容量较大，sessionStorage大约5M，localStorage约20M</li>
<li>只能存储字符串，可以将对象经过<code>JSON.stringify(obj)</code>编码后进行存储</li>
</ul>
<h3 id="使用背景"><a href="#使用背景" class="headerlink" title="使用背景"></a>使用背景</h3><p>WebStorage的目的是<strong>克服由cookie所带来的一些限制</strong>，当数据需要被严格控制在客户端时，不需要持续的将数据发回服务器。</p>
<p>WebStorage两个主要目标：</p>
<p>（1）提供一种在cookie之外存储会话数据的路径。</p>
<p>（2）提供一种存储大量可以跨会话存在的数据的机制。</p>
<p>HTML5的WebStorage提供了两种API：localStorage（本地存储）和sessionStorage（会话存储）。</p>
<h4 id="1、生命周期："><a href="#1、生命周期：" class="headerlink" title="1、生命周期："></a>1、生命周期：</h4><ul>
<li><p>localStorage:localStorage的生命周期是永久的，关闭页面或浏览器之后localStorage中的数据也不会消失。localStorage除非主动删除数据，否则数据永远不会消失。</p>
</li>
<li><p>sessionStorage的生命周期是在仅在当前会话下有效。sessionStorage引入了一个“浏览器窗口”的概念，sessionStorage是在同源的窗口中始终存在的数据。只要这个浏览器窗口没有关闭，即使刷新页面或者进入同源另一个页面，数据依然存在。同时独立的打开同一个窗口同一个页面，sessionStorage也是不一样的。</p>
</li>
</ul>
<h4 id="2、存储大小："><a href="#2、存储大小：" class="headerlink" title="2、存储大小："></a>2、存储大小：</h4><p>localStorage和sessionStorage的存储数据大小一般都是：5MB</p>
<h4 id="3、存储位置："><a href="#3、存储位置：" class="headerlink" title="3、存储位置："></a>3、存储位置：</h4><p>localStorage和sessionStorage都保存在客户端，不与服务器进行交互通信。</p>
<h4 id="4、存储内容类型："><a href="#4、存储内容类型：" class="headerlink" title="4、存储内容类型："></a>4、存储内容类型：</h4><p>localStorage和sessionStorage只能存储字符串类型，对于复杂的对象可以使用ECMAScript提供的JSON对象的stringify和parse来处理</p>
<h4 id="5、获取方式："><a href="#5、获取方式：" class="headerlink" title="5、获取方式："></a>5、获取方式：</h4><ul>
<li><p>localStorage：window.localStorage;</p>
</li>
<li><p>sessionStorage：window.sessionStorage;</p>
</li>
</ul>
<h4 id="6、应用场景：-1"><a href="#6、应用场景：-1" class="headerlink" title="6、应用场景："></a>6、应用场景：</h4><ul>
<li>localStoragese：常用于长期登录（+判断用户是否已登录），适合长期保存在本地的数据；</li>
<li>sessionStorage：敏感账号一次性登录；</li>
</ul>
<h4 id="7、WebStorage的优点："><a href="#7、WebStorage的优点：" class="headerlink" title="7、WebStorage的优点："></a>7、WebStorage的优点：</h4><p>（1）存储空间更大：cookie为4KB，而WebStorage是5MB；</p>
<p>（2）节省网络流量：WebStorage<strong>不会传送到服务器</strong>，存储在本地的数据可以直接获取，也不会像<strong>cookie</strong>一样<strong>每次请求都会传送到服务器</strong>，所以减少了客户端和服务器端的交互，<strong>节省</strong>了网络<strong>流量</strong>；</p>
<p>（3）对于那种只需要在用户浏览一组页面期间保存而关闭浏览器后就可以丢弃的数据，sessionStorage会非常方便；</p>
<p>（4）快速显示：有的数据存储在WebStorage上，再加上浏览器本身的缓存。获取数据时可以从本地获取会比从服务器端获取快得多，所以<strong>速度更快</strong>；</p>
<p>（5）安全性：WebStorage不会随着HTTP header发送到服务器端，所以安全性<strong>相对于cookie</strong>来说比<strong>较高</strong>一些，不会担心截获，但是仍然存在伪造问题；</p>
<p>（6）WebStorage提供了一些方法，数据操作比cookie方便；</p>
<ul>
<li><p> setItem (key, value) ——  保存数据，以键值对的方式储存信息。</p>
</li>
<li><p>getItem (key) ——  获取数据，将键值传入，即可获取到对应的value值。</p>
</li>
<li><p>removeItem (key) ——  删除单个数据，根据键值移除对应的信息。</p>
</li>
<li><p>clear () ——  删除所有的数据</p>
</li>
<li><p>key (index) —— 获取某个索引的key</p>
</li>
</ul>
<h3 id="localStorage常见API"><a href="#localStorage常见API" class="headerlink" title="localStorage常见API"></a>localStorage常见API</h3><ul>
<li>声明周期永久有效，除非手动删除，否则关闭页面也会存在</li>
<li>可以多窗口（页面）共享（同一浏览器可以共享）</li>
<li>以键值对的形式进行存储</li>
</ul>
<h4 id="存储数据"><a href="#存储数据" class="headerlink" title="存储数据"></a>存储数据</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.setItem(key, value)</span><br></pre></td></tr></table></figure>

<h4 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localStorage.getItem(key) </span><br></pre></td></tr></table></figure>

<h4 id="删除单条记录"><a href="#删除单条记录" class="headerlink" title="删除单条记录"></a>删除单条记录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localStorage.removeItem(key)</span><br></pre></td></tr></table></figure>

<h4 id="删除所有数据"><a href="#删除所有数据" class="headerlink" title="删除所有数据"></a>删除所有数据</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localStorage.clear()</span><br></pre></td></tr></table></figure>

<h4 id="记住用户登入案例"><a href="#记住用户登入案例" class="headerlink" title="记住用户登入案例"></a>记住用户登入案例</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;username&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;remember&quot;</span>&gt;</span>记住用户名</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> username = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#username&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> remember = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#remember&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (<span class="built_in">localStorage</span>.getItem(<span class="string">&#x27;username&#x27;</span>)) &#123;</span></span><br><span class="line"><span class="javascript">            username.value = <span class="built_in">localStorage</span>.getItem(<span class="string">&#x27;username&#x27;</span>)</span></span><br><span class="line"><span class="javascript">            remember.checked = <span class="literal">true</span></span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">        remember.addEventListener(<span class="string">&#x27;change&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (<span class="built_in">this</span>.checked) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">localStorage</span>.setItem(<span class="string">&#x27;username&#x27;</span>, username.value)</span></span><br><span class="line"><span class="javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">localStorage</span>.removeItem(<span class="string">&#x27;username&#x27;</span>)</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;)</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="sessionStorage常见API"><a href="#sessionStorage常见API" class="headerlink" title="sessionStorage常见API"></a>sessionStorage常见API</h3><ul>
<li>声明周期为关闭浏览器</li>
<li>在同一窗口（页面）下数据可以共享</li>
<li>以键值对的形式进行存储</li>
</ul>
<h4 id="存储数据-1"><a href="#存储数据-1" class="headerlink" title="存储数据"></a>存储数据</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sessionStorage.setItem(key, value)</span><br></pre></td></tr></table></figure>

<h4 id="获取数据-1"><a href="#获取数据-1" class="headerlink" title="获取数据"></a>获取数据</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sessionStorage.getItem(key) </span><br></pre></td></tr></table></figure>

<h4 id="删除单条记录-1"><a href="#删除单条记录-1" class="headerlink" title="删除单条记录"></a>删除单条记录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sessionStorage.removeItem(key)</span><br></pre></td></tr></table></figure>

<h4 id="删除所有数据-1"><a href="#删除所有数据-1" class="headerlink" title="删除所有数据"></a>删除所有数据</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sessionStorage.clear()</span><br></pre></td></tr></table></figure>



 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          Donate
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>Copyright： </strong>
          
          Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2022/04/01/2022/js-all/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2022/05/02/2022/js_skills/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            js常用技巧
          
        </div>
      </a>
    
    
      <a href="/2022/03/22/2022/algorithm_exercise/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">算法实战</div>
      </a>
    
  </nav>

   
<!-- valine评论 -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "s2JxkWTPgexxLPFUgyH6NOnG-gzGzoHsz",
    app_key: "Bp2E1k5nLuVzianDGDY3Mmh3",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "给我的文章加点评论吧~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
   
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2022
        <i class="ri-heart-fill heart_icon"></i> crazyzsh
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="crazyzsh博客空间"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/life">生活</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/resource">资源</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://raw.githubusercontent.com/crazyzsh/myImage/main/imageTest/alipay.png">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://raw.githubusercontent.com/crazyzsh/myImage/main/imageTest/wechatPay.png">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>